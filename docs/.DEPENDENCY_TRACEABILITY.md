# Dependency Traceability Guide

Automatic Dev Setup centralises dependency metadata so every binary, package, and artefact can be inspected quickly.

## 1. Version Locks (`config/version-locks.tsv`)
| Column | Description |
|--------|-------------|
| `component` | Human-readable identifier used in reports. |
| `command` | Invocation (with environment expansion) executed to obtain the version string. |
| `expected_regex` | POSIX regular expression matched against the first line of output. |
| `note` | Optional context (e.g., installation path or tap). |

Validate at any time:
```bash
./tools/ads-verify-versions.sh
```
The command writes a Markdown report to `~/.automatic_dev_setup/logs/version-lock-report-*.md` and exits non-zero if any component drifts from the agreed version range.

## 2. Checksum Catalogue (`config/download-checksums.tsv`)
Each line binds an artefact name to its canonical URL and SHA-256 digest. Secure downloads call `ads_fetch_with_checksum`, which will refuse to proceed if the computed digest differs. To add a new artefact:
1. Download it once (outside the installer) and compute the hash via `shasum -a 256 file`.
2. Append a new row to the catalogue.
3. Invoke `ads_fetch_with_checksum "name.ext" /desired/path` from the relevant script.

## 3. Restore Manifest (`config/restore-manifest.txt`)
Defines the files/directories captured in each automated restore point. Entries support environment variables (e.g., `$HOME/.zprofile`). The installer and `tools/ads-create-restore-point.sh` both expand the manifest, prune missing paths, then archive everything under `~/.automatic_dev_setup/backup`.

## 4. Cross-Referencing Modules
| Module | Dependency Sources |
|--------|--------------------|
| `02-homebrew-foundation` | `config/Brewfile.automatic-dev`, version locks (terraform, node), checksum catalogue (future downloads). |
| `03-shell-environment` | Restore manifest ensures shell start-up files are backed up before rewrite. |
| `04-python-ecosystem` | `config/requirements-automatic-dev.txt`, `config/constraints-automatic-dev.txt`, `config/version-locks.tsv` (Python interpreter). |
| `08-system-optimisation` | `config/version-locks.tsv` verifies CLI versions pre/post tune-up. |
| `09-integration-validation` | Runs the version verifier + ADS unit harness, publishing traceable reports. |

Maintaining these files keeps Section 4 (quality metrics), Section 6 (risk mitigation), and Section 7 (compliance scoring) of the audit framework in a permanently satisfied state.
